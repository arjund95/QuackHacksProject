<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <title>Atilla the Career Coach</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="styles.css">
    </head>

    <body>
        <div class="container">
            <div id="chat">
                <div style="position: relative; left: 2vh">
                    <h1>CAREER EXPERT</h1>
                    <div id="response">
                        <p id="result">
                            Lorem4 ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua.
                            Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
                            Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.
                            Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum. 
                        </p>
                    </div>
                    <div id="input">
                        <input type="text" id="user-input">
                        <button id="fetch-data">Enter</button>
                    </div>
                </div>
            </div>
            <div id="visual_area"> <!-- right hand side -->
                <!-- <div class="container">

                    </div>
                    <div>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>
            </div>
        </div>
    
        <!-- Include Axios via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script type="module">
        console.log("1");

        console.log("2");

        async function fetchCompletion(userMessage) {
        const apiKey = process.env.OPENAI_APIKEY; 
        const url = 'https://api.openai.com/v1/chat/completions';
        const headers = {
            'Authorization': `Bearer ${apiKey}`,
            'Content-Type': 'application/json'
        };
        const data = {
            model: 'gpt-3.5-turbo',
            messages: [
            { role: 'system', content: 'You are a helpful assistant.' },
            { role: 'user', content: userMessage }
            ]
        };

        try {
            const response = await axios.post(url, data, { headers });
            console.log(response.data)
            const result = response.data.choices[0].message.content;
            resultElement.textContent = result;
        } catch (error) {
            console.error("Error fetching data:", error);
            resultElement.textContent = "Error fetching data. Check console for details.";
        }
        }

        // DOM elements
        const userInputElement = document.getElementById('user-input');
        const fetchDataButton = document.getElementById('fetch-data');
        const resultElement = document.getElementById('result');

        // Event listener
        fetchDataButton.addEventListener('click', () => {
        const userInput = userInputElement.value;
        fetchCompletion(userInput);
        });
    </script>
    </body>
    
    
</html>